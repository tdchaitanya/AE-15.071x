letters <- read.csv("letters_ABPR.csv")
letters$isB = as.factor(letters$letter == "B")
library(caTools)
set.seed(1000)
spl = sample.split(letters$isB,SplitRatio = 0.5)
train = subset(letters,spl=TRUE)
test = subset(letters,spl=FALSE)
table(train$isB)
#1.1
2350/(2350+766)
#1.2
library(rpart)
library(rpart.plot)
CARTb = rpart(isB ~ . - letter, data=train, method="class")
pred = predict(CARTb, newdata = test, type = "class")
table(test$isB,pred)
(2280+665)/(2280+665+70+101)
#1.3
library(randomForest)
set.seed(1000)
rand = randomForest(isB ~ ., data = train)
predrf = predict(rand,newdata = test)
table(test$isB,predrf)
(2350+766)/(2350+766+0+0)
#2.1
letters$letter = as.factor( letters$letter )
set.seed(2000)
spl = sample.split(letters$letter,SplitRatio = 0.5)
train = subset(letters,spl=TRUE)
test = subset(letters,spl=FALSE)
table(test$letter)
803/(789+766+803+758)
#2.2
CARTletter = rpart(letter ~ . - isB, data=train2, method="class")
predictLetter = predict(CARTletter, newdata=test2, type="class")
(348+318+363+340)/nrow(test2) 
#2.3
set.seed(1000)
RFletter = randomForest(letter ~ . - isB, data=train2)
predictLetter = predict(RFletter, newdata=test2)
(390+380 +393+364)/nrow(test2)