FluTrain <- read.csv("FluTrain.csv")
summary(FluTrain)
FluTrain$Week
summary(FluTrain)
View(FluTrain)
which.max(FluTrain$ILI)
FluTrain$Week[303]
which.max(FluTrain$Queries)
rm(list=ls())
FluTrain <- read.csv("FluTrain.csv")
FluTrain$Week[which.max(FluTrain$ILI)]
FluTrain$Week[which.max(FluTrain$Queries)]
hist(FluTrain$ILI)
hist(log(FluTrain$ILI))
plot(log(FluTrain$ILI),FluTrain$Queries)
FluTrend1 <- lm(log(ILI ~ Queries,data = FluTrain))
FluTrend1 <- lm(log(ILI) ~ Queries,data = FluTrain)
summary(FluTrend1)
cor(log(FluTrain$ILI),FluTrain$Queries)
log(1/0.842033)
exp(-0.5*0.842033)
cor(FluTrain$Queries,log(FluTrain$ILI))
0.8420*0.8420
PredTest1 = exp(predict(FluTrend1, newdata=FluTest))
FluTest = read.csv("FluTest.csv")
PredTest1 = exp(predict(FluTrend1, newdata=FluTest))
FluTest$Week
?which
which(FluTest$Week == 2012-03-11)
which(FluTest$Week == '2012-03-11')
PredTest1[11]
PredTest1[which(FluTest$Week == "2012-03-11 - 2012-03-17")]
a <- PredTest1[which(FluTest$Week == "2012-03-11 - 2012-03-17")]
FluTest$ILI[11]
(FluTest$ILI[11] - a )/FluTest$ILI[11]
SSE = sum((FluTest$ILI - PredTest1)^2)
RMSE = sqrt(SSE/nrow(FluTest))
install.packages("zoo")
library(zoo)
ILILag2 = lag(zoo(FluTrain$ILI), -2, na.pad=TRUE)
FluTrain$ILILag2 = coredata(ILILag2)
summary(FluTrain$ILILag2)
plot(log(FluTrain$ILILag2),log(FluTrain$ILI))
FluTrend2 <- lm(log(ILI) ~ Queries + log(ILILag2),data = FluTrain)
summary(FluTrend2)
ILILag2 = lag(zoo(FluTest$ILI), -2, na.pad=TRUE)
FluTest$ILILag2 = coredata(ILILag2)
summary(FluTest$ILILag2)
FluTest$ILILag2
FluTrain$ILI
FluTest$ILILag2[1] = FluTrain$ILI[416]
FluTest$ILILag2[2] = FluTrain$ILI[417]
FluTest$ILILag2
PredTest2 = exp(predict(FluTrend2, newdata=FluTest))
SSE = sum((FluTest$ILI - PredTest2)^2)
RMSE = sqrt(SSE/nrow(FluTest))
SSE = sum((FluTest$ILI - PredTest1)^2)
RMSE = sqrt(SSE/nrow(FluTest))
SSE2 = sum((FluTest$ILI - PredTest2)^2)
RMSE2 = sqrt(SSE/nrow(FluTest))
rm(lsit=ls())
rm(list=ls())
#Problem 1.1
FluTrain <- read.csv("FluTrain.csv")
FluTrain$Week[which.max(FluTrain$ILI)]
FluTrain$Week[which.max(FluTrain$Queries)]
#Problem 1.2
hist(FluTrain$ILI)
#Problem 1.3
plot(log(FluTrain$ILI),FluTrain$Queries)
#Problem 2.2
FluTrend1 <- lm(log(ILI) ~ Queries,data = FluTrain)
summary(FluTrend1)
#Problem 2.3
cor(FluTrain$Queries,log(FluTrain$ILI))
#Problem 3.1
FluTest = read.csv("FluTest.csv")
PredTest1 = exp(predict(FluTrend1, newdata=FluTest))
a <- PredTest1[which(FluTest$Week == "2012-03-11 - 2012-03-17")]
#Problem 3.2
(FluTest$ILI[11] - a )/FluTest$ILI[11]
#Problem 3.3
SSE = sum((FluTest$ILI - PredTest1)^2)
RMSE = sqrt(SSE/nrow(FluTest))
#Problem 4.1
library(zoo)
ILILag2 = lag(zoo(FluTrain$ILI), -2, na.pad=TRUE)
FluTrain$ILILag2 = coredata(ILILag2)
summary(FluTrain$ILILag2)
#Problem 4.2
plot(log(FluTrain$ILILag2),log(FluTrain$ILI))
#Problem 4.3
FluTrend2 <- lm(log(ILI) ~ Queries + log(ILILag2),data = FluTrain)
summary(FluTrend2)
#Problem 5.1
ILILag2 = lag(zoo(FluTest$ILI), -2, na.pad=TRUE)
FluTest$ILILag2 = coredata(ILILag2)
summary(FluTest$ILILag2)
#Problem 5.2
FluTest$ILILag2[1] = FluTrain$ILI[416]
FluTest$ILILag2[2] = FluTrain$ILI[417]
#Problem 5.3
PredTest2 = exp(predict(FluTrend2, newdata=FluTest))
SSE2 = sum((FluTest$ILI - PredTest2)^2)
RMSE2 = sqrt(SSE/nrow(FluTest))
PredTest2 = exp(predict(FluTrend2, newdata=FluTest))
SSE2 = sum((FluTest$ILI - PredTest2)^2)
RMSE2 = sqrt(SSE/nrow(FluTest))
sqrt(mean((PredTest2-FluTest$ILI)^2)).
sqrt(mean((PredTest2-FluTest$ILI)^2))
#Problem 5.4
PredTest2 = exp(predict(FluTrend2, newdata=FluTest))
sqrt(mean((PredTest2-FluTest$ILI)^2)).
sqrt(mean((PredTest2-FluTest$ILI)^2))
