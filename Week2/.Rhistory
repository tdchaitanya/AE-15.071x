q()
# VIDEO 4
# Read in data
wine = read.csv("wine.csv")
str(wine)
summary(wine)
# Linear Regression (one variable)
model1 = lm(Price ~ AGST, data=wine)
summary(model1)
# Sum of Squared Errors
model1$residuals
SSE = sum(model1$residuals^2)
SSE
# Linear Regression (two variables)
model2 = lm(Price ~ AGST + HarvestRain, data=wine)
summary(model2)
# Sum of Squared Errors
SSE = sum(model2$residuals^2)
SSE
# Linear Regression (all variables)
model3 = lm(Price ~ AGST + HarvestRain + WinterRain + Age + FrancePop, data=wine)
summary(model3)
# Sum of Squared Errors
SSE = sum(model3$residuals^2)
SSE
model = lm(Price ~  HarvestRain + WinterRain,data = wine)
ssummary(model)
summary(model)
# VIDEO 5
# Remove FrancePop
model4 = lm(Price ~ AGST + HarvestRain + WinterRain + Age, data=wine)
summary(model4)
# VIDEO 6
# Correlations
cor(wine$WinterRain, wine$Price)
cor(wine$Age, wine$FrancePop)
cor(wine)
# Remove Age and FrancePop
model5 = lm(Price ~ AGST + HarvestRain + WinterRain, data=wine)
summary(model5)
# VIDEO 7
# Read in test set
wineTest = read.csv("wine_test.csv")
str(wineTest)
# Make test set predictions
predictTest = predict(model4, newdata=wineTest)
predictTest
# Compute R-squared
SSE = sum((wineTest$Price - predictTest)^2)
SST = sum((wineTest$Price - mean(wine$Price))^2)
1 - SSE/SST
rm(list=ls)
rm(list=ls())
q()
# VIDEO 2
# Read in data
baseball = read.csv("baseball.csv")
str(baseball)
# Subset to only include moneyball years
moneyball = subset(baseball, Year < 2002)
str(moneyball)
# Compute Run Difference
moneyball$RD = moneyball$RS - moneyball$RA
str(moneyball)
# Scatterplot to check for linear relationship
plot(moneyball$RD, moneyball$W)
# Regression model to predict wins
WinsReg = lm(W ~ RD, data=moneyball)
summary(WinsReg)
# VIDEO 3
str(moneyball)
# Regression model to predict runs scored
# VIDEO 2
# Read in data
baseball = read.csv("baseball.csv")
str(baseball)
# Subset to only include moneyball years
moneyball = subset(baseball, Year < 2002)
str(moneyball)
# Compute Run Difference
moneyball$RD = moneyball$RS - moneyball$RA
str(moneyball)
# Scatterplot to check for linear relationship
plot(moneyball$RD, moneyball$W)
# Regression model to predict wins
WinsReg = lm(W ~ RD, data=moneyball)
summary(WinsReg)
# VIDEO 3
str(moneyball)
# Regression model to predict runs scored
RunsReg = lm(RS ~ OBP + SLG + BA, data=moneyball)
summary(RunsReg)
RunsReg = lm(RS ~ OBP + SLG, data=moneyball)
summary(RunsReg)
predict(WinsReg,99)
predict(WinsReg,c(99))
predict(WinsReg,newdata = c(99))
predict(WinsReg,newdata = 99)
predict(WinsReg,newdata = new)
predict = predict(WinsReg,newdata = new)
prediction = predict(WinsReg,newdata = new)
prediction = predict.lm(WinsReg,newdata = new)
# Subset to only include moneyball years
moneyball = subset(baseball, Year < 2002)
str(moneyball)
# Compute Run Difference
moneyball$RD = moneyball$RS - moneyball$RA
str(moneyball)
# Scatterplot to check for linear relationship
plot(moneyball$RD, moneyball$W)
# Regression model to predict wins
WinsReg = lm(W ~ RD, data=moneyball)
summary(WinsReg)
new = data.frame(RD=c(99))
prediction = predict.lm(WinsReg,newdata = new)
prediction
# VIDEO 3
str(moneyball)
# Regression model to predict runs scored
RunsReg = lm(RS ~ OBP + SLG + BA, data=moneyball)
summary(RunsReg)
RunsReg = lm(RS ~ OBP + SLG, data=moneyball)
summary(RunsReg)
2737.77*0.311 + 1584.91*0.405 -804.63
WinsReg = lm(W ~ RD, data=moneyball)
summary(WinsReg)
2737.77*0.297 + 1584.91*0.370 -804.63
str(moneyball)
testInheritedMethods() = lm(RA ~ OOBP + OSLG, data=moneyball)
test = lm(RA ~ OOBP + OSLG, data=moneyball)
test.summary
test.summary()
summary(test)
2913.60*0.297+1514.29*0.370-837.38
RunsReg = lm(RS ~ OBP + SLG, data=moneyball)
summary(RunsReg)
new = data.frame(OBP=c(0.338,0.391,0.369,0.313,0.361),SLG=c(0.540,0.450,0.374,0.447,0.500))
prediction = predict.lm(WinsReg,newdata = new)
2737.77*0.338+1584.91*0.540-804.63
2737.77*0.391+1584.91*0.450-804.63
2737.77*0.369+1584.91*0.374-804.63
2737.77*0.313+1584.91*0.447-804.63
2737.77*0.361+1584.91*0.500-804.63
q()
climate<- read.csv("climate_change.csv")
train <- subset(climate,climate$Year <= 2006)
test <- subset(climate,climate$Year > 2006)
colnames(train)
m1 <- lm(Temp ~ MEI + CO2 + CH4 + N2O + CFC.11 + CFC.12 + TSI + Aerosols,data = train)
summary(m1)
cor(train)
m1 <- lm(Temp ~ MEI + TSI + Aerosols + N2O,data = train)
summary(m1)
m3 <- step(m1)
summary(m3)
m1 <- lm(Temp ~ MEI + CO2 + CH4 + N2O + CFC.11 + CFC.12 + TSI + Aerosols,data = train)
m3 <- step(m1)
summary(m3)
pr <- predict.lm(m3,newdata = test)
summary(pr)
pr <- predict(m3,newdata = test)
summary(pr)
sum((pr-test$Temp)^2)
sum((test$Temp-mean(test$Temp))^2)
0.2176444/0.26751
1-0.8135935
sstotal <- sum((test$Temp - mean(test$Temp))*2)
ssres <- sum((test$Temp - pr)*2)
1-(ssres/sstotal)
ssres
ssres <- sum((test$Temp - pr)^2)
sstotal <- sum((test$Temp - mean(test$Temp))^2)
ssres
sstotal
1-(ssres/sstotal)
SSE <- sum((test$Temp - pr)^2)
SST <- sum((test$Temp - mean(test$Temp))^2)
1 - SSE/SST
m3 <- step(m1)
pr <- predict(m3,newdata = test)
SSE <- sum((test$Temp - pr)^2)
SST <- sum((test$Temp - mean(test$Temp))^2)
1 - SSE/SST
test
pr
pr
test$Temp
prdt <- predict(m3,newdata = test)
prdt
# VIDEO 4
# Read in data
wine = read.csv("wine.csv")
str(wine)
summary(wine)
# Linear Regression (one variable)
model1 = lm(Price ~ AGST, data=wine)
summary(model1)
# Sum of Squared Errors
model1$residuals
SSE = sum(model1$residuals^2)
SSE
# Linear Regression (two variables)
model2 = lm(Price ~ AGST + HarvestRain, data=wine)
summary(model2)
# Sum of Squared Errors
SSE = sum(model2$residuals^2)
SSE
# Linear Regression (all variables)
model3 = lm(Price ~ AGST + HarvestRain + WinterRain + Age + FrancePop, data=wine)
summary(model3)
# Sum of Squared Errors
SSE = sum(model3$residuals^2)
SSE
# VIDEO 5
# Remove FrancePop
model4 = lm(Price ~ AGST + HarvestRain + WinterRain + Age, data=wine)
summary(model4)
# VIDEO 6
# Correlations
cor(wine$WinterRain, wine$Price)
cor(wine$Age, wine$FrancePop)
cor(wine)
# Remove Age and FrancePop
model5 = lm(Price ~ AGST + HarvestRain + WinterRain, data=wine)
summary(model5)
# VIDEO 7
# Read in test set
wineTest = read.csv("wine_test.csv")
str(wineTest)
# Make test set predictions
predictTest = predict(model4, newdata=wineTest)
predictTest
# Compute R-squared
SSE = sum((wineTest$Price - predictTest)^2)
SST = sum((wineTest$Price - mean(wine$Price))^2)
1 - SSE/SST
wineTest$Price
climateStep <- step(m1)
summary(climateStep)
tempPredict = predict(climateStep, newdata = test)
SSE = sum((tempPredict - test$Temp)^2)
SST = sum( (mean(train$Temp) - test$Temp)^2)
R2 = 1 - SSE/SST
R2
q()
pisaTrain <- read.csv("pisaTrain.csv")
pisaTrain <- read.csv("pisaTrain2009.csv")
pisaTrain <- read.csv("pisa2009Train.csv")
pisaTrain <- read.csv("pisa2009Train.csv")
q()
rm(list=ls())
pisaTrain <- read.csv("pisa2009Train.csv")
pisaTrain <- read.csv("pisa2009train.csv")
pisaTest <- read.csv("pisa2009test.csv")
pisaTrain = na.omit(pisaTrain)
pisaTest = na.omit(pisaTest)
str(pisaTrain)
levels(pisaTrain$raceeth)
pisaTrain$raceeth = relevel(pisaTrain$raceeth, "White")
pisaTest$raceeth = relevel(pisaTest$raceeth, "White")
lmScore <- lm(readingScore ~ . ,data = pisaTrain)
summary(lmScore)
q()
sum(lmScore$residuals)
RMSE <- sqrt(sum(lmScore$residuals^2)/nrow(pisaTrain))
summary(lmScore)
29.54*2
predTest <- predict(lmScore,newdata = )
predTest <- predict(lmScore,newdata = pisaTest)
summary(predTest)
637.7-352.2
SSE = sum((pisaTest$readingScore-predTest)^2)
SST = sum( (mean(pisaTest$readingScore) - predTest)^2)
SSE = sum((predTest - pisaTest$readingScore)^2)
SSE
RMSE <- sqrt(SSE/nrow(predTest))
RMSE <- sqrt(SSE/nrow(pisaTest))
1-(SSE/SST)
1- SSE/SST
5762082/2687610
mean(pisaTrain$readingScore)
SST
sum((pisaTrain$readingScore - mean(pisaTrain$readingScore))^2)
q()
bias = mean(pisaTrain$readingScore)
SST = sum((pisaTest$readingScore - bias)^2)
bias
SST
1 - SSE/SST
rm(list=ls())
